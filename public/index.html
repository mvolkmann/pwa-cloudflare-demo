<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PWA Demo</title>

    <meta charset="UTF-8" />
    <!-- unsafe-inline is needed in order to use Alpine.
         See https://alpinejs.dev/advanced/csp -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'"
    />
    <meta name="theme-color" content="#ff0000" />
    <!-- Adding user-scalable="no" prevents double-taps from zooming. -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0,
    maximum-scale=1.0, user-scalable=no"
    />

    <link rel="manifest" href="/manifest.json" />
    <link rel="stylesheet" href="/styles.css" />

    <script defer src="/alpine.min.js"></script>
    <script defer src="/htmx.min.js"></script>

    <script>
      async function setup() {
        if ("serviceWorker" in navigator) {
          try {
            const registration = await navigator.serviceWorker.register(
              "/service-worker.js"
            );
            console.log(
              "service worker registered with scope",
              registration.scope
            );
          } catch (error) {
            console.error("service worker registered failed:", error);
          }
        }
      }
      setup();
    </script>
  </head>
  <body>
    <h1>PWA Demo</h1>

    <section>
      <h2>Alpine Counter</h2>
      <div class="counter" x-data="{ count: 0 }">
        <button x-bind:disabled="count <= 0" x-on:click="count--">-</button>
        <div x-text="count"></div>
        <button x-on:click="count++">+</button>
      </div>
    </section>

    <section>
      <button hx-get="/get-text" hx-target="#text">Get Text</button>
      <span id="text"></span>
    </section>

    <section>
      <button hx-get="/get-html" hx-target="#html">Get HTML</button>
      <span id="html"></span>
    </section>
  </body>
</html>
